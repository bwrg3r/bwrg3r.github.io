import{r as s}from"./index.BCtMShv3.js";import{u as O}from"./index.Cm2v_UWq.js";import{a as A}from"./index.CBjpc3V2.js";function y(n,e){return s.useReducer((t,r)=>e[t][r]??t,n)}var v=n=>{const{present:e,children:t}=n,r=T(e),o=typeof t=="function"?t({present:r.isPresent}):s.Children.only(t),c=O(r.ref,P(o));return typeof t=="function"||r.isPresent?s.cloneElement(o,{ref:c}):null};v.displayName="Presence";function T(n){const[e,t]=s.useState(),r=s.useRef({}),o=s.useRef(n),c=s.useRef("none"),p=n?"mounted":"unmounted",[N,a]=y(p,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return s.useEffect(()=>{const i=l(r.current);c.current=N==="mounted"?i:"none"},[N]),A(()=>{const i=r.current,m=o.current;if(m!==n){const f=c.current,u=l(i);n?a("MOUNT"):u==="none"||i?.display==="none"?a("UNMOUNT"):a(m&&f!==u?"ANIMATION_OUT":"UNMOUNT"),o.current=n}},[n,a]),A(()=>{if(e){let i;const m=e.ownerDocument.defaultView??window,d=u=>{const M=l(r.current).includes(u.animationName);if(u.target===e&&M&&(a("ANIMATION_END"),!o.current)){const E=e.style.animationFillMode;e.style.animationFillMode="forwards",i=m.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=E)})}},f=u=>{u.target===e&&(c.current=l(r.current))};return e.addEventListener("animationstart",f),e.addEventListener("animationcancel",d),e.addEventListener("animationend",d),()=>{m.clearTimeout(i),e.removeEventListener("animationstart",f),e.removeEventListener("animationcancel",d),e.removeEventListener("animationend",d)}}else a("ANIMATION_END")},[e,a]),{isPresent:["mounted","unmountSuspended"].includes(N),ref:s.useCallback(i=>{i&&(r.current=getComputedStyle(i)),t(i)},[])}}function l(n){return n?.animationName||"none"}function P(n){let e=Object.getOwnPropertyDescriptor(n.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?n.ref:(e=Object.getOwnPropertyDescriptor(n,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?n.props.ref:n.props.ref||n.ref)}var R=s.createContext(void 0);function U(n){const e=s.useContext(R);return n||e||"ltr"}function C(n,e,{checkForDefaultPrevented:t=!0}={}){return function(o){if(n?.(o),t===!1||!o.defaultPrevented)return e?.(o)}}export{v as P,C as c,U as u};
